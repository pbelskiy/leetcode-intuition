{
  "questionId": "3961",
  "title": "Find Students with Study Spiral Pattern",
  "content": "<p>Table: <code>students</code></p>\n\n<pre>\n+--------------+---------+\n| Column Name  | Type    |\n+--------------+---------+\n| student_id   | int     |\n| student_name | varchar |\n| major        | varchar |\n+--------------+---------+\nstudent_id is the unique identifier for this table.\nEach row contains information about a student and their academic major.\n</pre>\n\n<p>Table: <code>study_sessions</code></p>\n\n<pre>\n+---------------+---------+\n| Column Name   | Type    |\n+---------------+---------+\n| session_id    | int     |\n| student_id    | int     |\n| subject       | varchar |\n| session_date  | date    |\n| hours_studied | decimal |\n+---------------+---------+\nsession_id is the unique identifier for this table.\nEach row represents a study session by a student for a specific subject.\n</pre>\n\n<p>Write a solution to find students who follow the <strong>Study Spiral Pattern</strong>&nbsp;- students who consistently study multiple subjects in a rotating cycle.</p>\n\n<ul>\n\t<li>A Study Spiral Pattern means a student studies at least <code>3</code><strong> different subjects</strong> in a repeating sequence</li>\n\t<li>The pattern must repeat for <strong>at least </strong><code>2</code><strong> complete cycles</strong> (minimum <code>6</code> study sessions)</li>\n\t<li>Sessions must be <strong>consecutive dates</strong> with no gaps longer than <code>2</code> days between sessions</li>\n\t<li>Calculate the <strong>cycle length</strong> (number of different subjects in the pattern)</li>\n\t<li>Calculate the <strong>total study hours</strong> across all sessions in the pattern</li>\n\t<li>Only include students with cycle length of <strong>at least </strong><code>3</code><strong> subjects</strong></li>\n</ul>\n\n<p>Return <em>the result table ordered by cycle length in <strong>descending</strong> order, then by total study hours in <strong>descending</strong> order</em>.</p>\n\n<p>The result format is in the following example.</p>\n\n<p>&nbsp;</p>\n<p><strong class=\"example\">Example:</strong></p>\n\n<div class=\"example-block\">\n<p><strong>Input:</strong></p>\n\n<p>students table:</p>\n\n<pre class=\"example-io\">\n+------------+--------------+------------------+\n| student_id | student_name | major            |\n+------------+--------------+------------------+\n| 1          | Alice Chen   | Computer Science |\n| 2          | Bob Johnson  | Mathematics      |\n| 3          | Carol Davis  | Physics          |\n| 4          | David Wilson | Chemistry        |\n| 5          | Emma Brown   | Biology          |\n+------------+--------------+------------------+\n</pre>\n\n<p>study_sessions table:</p>\n\n<pre class=\"example-io\">\n+------------+------------+------------+--------------+---------------+\n| session_id | student_id | subject    | session_date | hours_studied |\n+------------+------------+------------+--------------+---------------+\n| 1          | 1          | Math       | 2023-10-01   | 2.5           |\n| 2          | 1          | Physics    | 2023-10-02   | 3.0           |\n| 3          | 1          | Chemistry  | 2023-10-03   | 2.0           |\n| 4          | 1          | Math       | 2023-10-04   | 2.5           |\n| 5          | 1          | Physics    | 2023-10-05   | 3.0           |\n| 6          | 1          | Chemistry  | 2023-10-06   | 2.0           |\n| 7          | 2          | Algebra    | 2023-10-01   | 4.0           |\n| 8          | 2          | Calculus   | 2023-10-02   | 3.5           |\n| 9          | 2          | Statistics | 2023-10-03   | 2.5           |\n| 10         | 2          | Geometry   | 2023-10-04   | 3.0           |\n| 11         | 2          | Algebra    | 2023-10-05   | 4.0           |\n| 12         | 2          | Calculus   | 2023-10-06   | 3.5           |\n| 13         | 2          | Statistics | 2023-10-07   | 2.5           |\n| 14         | 2          | Geometry   | 2023-10-08   | 3.0           |\n| 15         | 3          | Biology    | 2023-10-01   | 2.0           |\n| 16         | 3          | Chemistry  | 2023-10-02   | 2.5           |\n| 17         | 3          | Biology    | 2023-10-03   | 2.0           |\n| 18         | 3          | Chemistry  | 2023-10-04   | 2.5           |\n| 19         | 4          | Organic    | 2023-10-01   | 3.0           |\n| 20         | 4          | Physical   | 2023-10-05   | 2.5           |\n+------------+------------+------------+--------------+---------------+\n</pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"example-io\">\n+------------+--------------+------------------+--------------+-------------------+\n| student_id | student_name | major            | cycle_length | total_study_hours |\n+------------+--------------+------------------+--------------+-------------------+\n| 2          | Bob Johnson  | Mathematics      | 4            | 26.0              |\n| 1          | Alice Chen   | Computer Science | 3            | 15.0              |\n+------------+--------------+------------------+--------------+-------------------+\n</pre>\n\n<p><strong>Explanation:</strong></p>\n\n<ul>\n\t<li><strong>Alice Chen (student_id = 1):</strong>\n\n\t<ul>\n\t\t<li>Study sequence: Math &rarr; Physics &rarr; Chemistry &rarr; Math &rarr; Physics &rarr; Chemistry</li>\n\t\t<li>Pattern: 3 subjects (Math, Physics, Chemistry) repeating for 2 complete cycles</li>\n\t\t<li>Consecutive dates: Oct 1-6 with no gaps &gt; 2 days</li>\n\t\t<li>Cycle length: 3 subjects</li>\n\t\t<li>Total hours: 2.5 + 3.0 + 2.0 + 2.5 + 3.0 + 2.0 = 15.0 hours</li>\n\t</ul>\n\t</li>\n\t<li><strong>Bob Johnson (student_id = 2):</strong>\n\t<ul>\n\t\t<li>Study sequence: Algebra &rarr; Calculus &rarr; Statistics &rarr; Geometry &rarr; Algebra &rarr; Calculus &rarr; Statistics &rarr; Geometry</li>\n\t\t<li>Pattern: 4 subjects (Algebra, Calculus, Statistics, Geometry) repeating for 2 complete cycles</li>\n\t\t<li>Consecutive dates: Oct 1-8 with no gaps &gt; 2 days</li>\n\t\t<li>Cycle length: 4 subjects</li>\n\t\t<li>Total hours: 4.0 + 3.5 + 2.5 + 3.0 + 4.0 + 3.5 + 2.5 + 3.0 = 26.0&nbsp;hours</li>\n\t</ul>\n\t</li>\n\t<li><strong>Students not included:</strong>\n\t<ul>\n\t\t<li>Carol Davis (student_id = 3): Only 2 subjects (Biology, Chemistry) - doesn&#39;t meet minimum 3 subjects requirement</li>\n\t\t<li>David Wilson (student_id = 4): Only 2 study sessions with a 4-day gap - doesn&#39;t meet consecutive dates requirement</li>\n\t\t<li>Emma Brown (student_id = 5): No study sessions recorded</li>\n\t</ul>\n\t</li>\n</ul>\n\n<p>The result table is ordered by cycle_length in descending order, then by total_study_hours in descending order.</p>\n</div>\n",
  "difficulty": "Hard",
  "topicTags": []
}